<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <!--
  <script src="./resources/jsapi" type="text/javascript"></script>
  <script type="text/javascript" async>google.load("jquery", "1.3.2");</script>
 -->


<style type="text/css">
  @font-face {
   font-family: 'Avenir Book';
   src: url("./fonts/Avenir_Book.ttf"); /* File to be stored at your site */
   }

  body {
    font-family: "Avenir Book", "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
    font-weight:300;
    font-size:14px;
    margin-left: auto;
    margin-right: auto;
    width: 800px;
  }
  h1 {
    font-weight:300;
  }
  h2 {
    font-weight:300;
  }

  p {
    font-weight:300;
    line-height: 1.4;
  }

  code {
    font-size: 0.8rem;
    margin: 0 0.2rem;
    padding: 0.5rem 0.8rem;
    white-space: nowrap;
    background: #efefef;
    border: 1px solid #d3d3d3;
    color: #000000;
    border-radius: 3px;
  }

  pre > code {
    display: block;
    white-space: pre;
    line-height: 1.5;
    padding: 0;
    margin: 0;
  }

  pre.prettyprint > code {
    border: none;
  }



  .disclaimerbox {
    background-color: #eee;
    border: 1px solid #eeeeee;
    border-radius: 10px ;
    -moz-border-radius: 10px ;
    -webkit-border-radius: 10px ;
    padding: 20px;
  }

  video.header-vid {
    height: 140px;
    border: 1px solid black;
    border-radius: 10px ;
    -moz-border-radius: 10px ;
    -webkit-border-radius: 10px ;
  }

  img.header-img {
    height: 140px;
    border: 1px solid black;
    border-radius: 10px ;
    -moz-border-radius: 10px ;
    -webkit-border-radius: 10px ;
  }

  img.rounded {
    border: 0px solid #eeeeee;
    border-radius: 10px ;
    -moz-border-radius: 10px ;
    -webkit-border-radius: 10px ;

  }

  a:link,a:visited
  {
    color: #1367a7;
    text-decoration: none;
  }
  a:hover {
    color: #208799;
  }

  td.dl-link {
    height: 160px;
    text-align: center;
    font-size: 22px;
  }

  .layered-paper-big { /* modified from: http://css-tricks.com/snippets/css/layered-paper/ */
    box-shadow:
            0px 0px 1px 1px rgba(0,0,0,0.35), /* The top layer shadow */
            5px 5px 0 0px #fff, /* The second layer */
            5px 5px 1px 1px rgba(0,0,0,0.35), /* The second layer shadow */
            10px 10px 0 0px #fff, /* The third layer */
            10px 10px 1px 1px rgba(0,0,0,0.35), /* The third layer shadow */
            15px 15px 0 0px #fff, /* The fourth layer */
            15px 15px 1px 1px rgba(0,0,0,0.35), /* The fourth layer shadow */
            20px 20px 0 0px #fff, /* The fifth layer */
            20px 20px 1px 1px rgba(0,0,0,0.35), /* The fifth layer shadow */
            25px 25px 0 0px #fff, /* The fifth layer */
            25px 25px 1px 1px rgba(0,0,0,0.35); /* The fifth layer shadow */
    margin-left: 10px;
    margin-right: 45px;
  }


  .layered-paper { /* modified from: http://css-tricks.com/snippets/css/layered-paper/ */
    box-shadow:
            0px 0px 1px 1px rgba(0,0,0,0.35), /* The top layer shadow */
            5px 5px 0 0px #fff, /* The second layer */
            5px 5px 1px 1px rgba(0,0,0,0.35), /* The second layer shadow */
            10px 10px 0 0px #fff, /* The third layer */
            10px 10px 1px 1px rgba(0,0,0,0.35); /* The third layer shadow */
    margin-top: 5px;
    margin-left: 10px;
    margin-right: 30px;
    margin-bottom: 5px;
  }

  .vert-cent {
    position: relative;
      top: 50%;
      transform: translateY(-50%);
  }

  hr
  {
    border: 0;
    height: 1px;
    background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));
  }
</style>



    <title>The Low-Rank Simplicity Bias in Deep Networks</title>
 </head>

  <body>
        <br>
          <center>
		  <span style="font-size:32px">The Low-Rank Simplicity Bias in Deep Networks</span><br><br><br>
          </center>
          <table align="center" width="800px">
            <tbody><tr>
                    <td align="center" width="160px">
              <center>
                <span style="font-size:16px"><a href="http://minyounghuh.com">Minyoung Huh</a><sup>1</sup></span>
                </center>
                </td>
                    <td align="center" width="160px">
              <center>
                <span style="font-size:16px"><a href="https://scholar.google.com/citations?user=GSHmKZkAAAAJ&hl=en">Hossein Mobahi</a><sup>2</sup></span>
                </center>
                </td>
                    <td align="center" width="160px">
              <center>
                <span style="font-size:16px"><a href="https://richzhang.github.io/">Richard Zhang</a><sup>3</sup></span>
                </center>
                </td>
                    <td align="center" width="160px">
              <center>
                <span style="font-size:16px"><a href="https://scholar.google.com/citations?user=7N-ethYAAAAJ&hl=en">Brian Cheung</a><sup>1 4</sup></span>
                </center>
                </td>
                    <td align="center" width="160px">
              <center>
                <span style="font-size:16px"><a href="https://people.csail.mit.edu/pulkitag/">Pulkit Agrawal</a><sup>1</sup></span>
                </center>
                </td>
                    <td align="center" width="160px">
              <center>
                <span style="font-size:16px"><a href="http://web.mit.edu/phillipi/">Phillip Isola</a><sup>1</sup></span>
                </center>
            </tr>

        </tbody></table><br>

          <table align="center" width="700px">
            <tbody><tr>
                    <td align="center" width="50px">
              <center>
                    <span style="font-size:16px"></span>
                </center>
                </td>
                    <td align="center" width="250px">
              <center>
                    <span style="font-size:16px"><sup>1</sup>MIT CSAIL</span>
                </center>
                </td>
                    <td align="center" width="250px">
              <center>
                    <span style="font-size:16px"><sup>2</sup>Google Research</span>
                </center>
                </td>
                    <td align="center" width="250px">
              <center>
                    <span style="font-size:16px"><sup>3</sup>Adobe Research</span>
                </center>
                </td>
                    <td align="center" width="250px">
              <center>
                    <span style="font-size:16px"><sup>4</sup>MIT BCS</span>
                </center>
                </td>
                    <td align="center" width="50px">
              <center>
                    <span style="font-size:16px"></span>
                </center>
                </td>
        </tr></tbody></table>
          <table align="center" width="700px">
            <tbody><tr>
              <td align="center" width="200px">
                <center>
                  <br>
                  <span style="font-size:20px">
                    <a href="https://github.com/minyoungg/overparam"><b>⏵code</b></a>
                  </span>
                </center>
              </td>

              <td align="center" width="200px">
                <center>
                  <br>
                  <span style="font-size:20px">
                    <a href="./resources/overparam-v2.pdf"><b>⏵paper</b></a>
                    <br />
                  </span>
                </center>
              </td>

              <td align="center" width="200px">
                <center>
                  <br>
                  <span style="font-size:20px">
                    <a href="https://arxiv.org/abs/2103.10427"><b>⏵arxiv</b></a>
                  </span>
                </center>
              </td>


              <td align="center" width="200px">
                <center>
                  <br>
                  <span style="font-size:20px">
                    <a href="./cite.txt"><b>⏵cite</b></a>
                  </span>
                </center>
              </td>

            </tr>
          </tbody>
          </table>
          <br />
          <h4>**For the latest version always use [<a href="./resources/overparam-v2.pdf">paper</a>]: (current: rev2 - 10/11/21)</h4>

        <hr>
        <center>
          <h2>
            <b>Abstract</b>
          </h2>
        </center>
        <p>
        <left>
          Modern deep neural networks are highly over-parameterized compared to the data on which they are trained, yet they often generalize remarkably well. A flurry of recent work has asked: why do deep networks not overfit to their training data?
    In this work, we make a series of empirical observations that investigate the hypothesis that deeper networks are inductively biased to find solutions with lower rank embeddings. We conjecture that this bias exists because the volume of functions that maps to low-rank embedding increases with depth. We show empirically that our claim holds true on finite width linear and non-linear models and show that these are the solutions that generalize well. We then show that the low-rank simplicity bias exists even after training, using a wide variety of commonly used optimizers. We found this phenomenon to be resilient to initialization, hyper-parameters, and learning methods.
    We further demonstrate how linear over-parameterization of deep non-linear models can be used to induce low-rank bias, improving generalization performance without changing the effective model capacity. Practically, we demonstrate that simply linearly over-parameterizing standard models at training time can improve performance on image classification tasks, including ImageNet.
        </left>
      </p>
      <br>

      <hr>
      <center> <h2> <b>Results</b> </h2> </center>
      <br />
      <h4 style="background-color:ECECEC; padding:20;">⏵<b><u>Observation 1</u></b><br />
          Randomly initialized deep neural networks are biased to correspond to Gram matrices with a low effective rank.
      </h4>
      <p> </p>
      <p><img class="rounded"  src="./images/obs-1.png" width="800px"></p>

      <br><br>
      <h4 style="background-color:ECECEC; padding:20;">⏵<b><u>Observation 2</u></b><br />
          Deep neural networks trained with gradient descent also learns to map data to simple embedding with low effective rank.
      </h4>
      <p> </p>
      <p><img class="rounded"  src="./images/obs-2.png" width="800px"></p>

      <br><br>
      <h4 style="background-color:ECECEC; padding:20;">⏵<b><u>Observation 3</u></b><br />
          Deep neural networks trained with common and natural choices of optimizers also exhibit the low-rank embedding bias.
      </h4>
      <p> </p>

      <p><center><img class="rounded"  src="./images/obs-3.png" width="500px"></center></p>

      <br><br>
      <h4 style="background-color:ECECEC; padding:20;">⏵<b><u>Observation 4</u></b><br />
          Deep neural networks are biased towards learning low-rank embeddings regardless of the initialization.
      </h4>
      <p><img class="rounded"  src="./images/obs-4.png" width="800px"></p>

      <br>
      <hr>
      <center> <h2> Try our PyTorch code </h2> </center>
      Install our code <a href="https://github.com/minyoungg/overparam"> [<b>github</b>] </a>
      <pre><code>
      <font color="00509d">>>></font> <font color="1a936f">git clone</font> https://github.com/minyoungg/overparam
      <font color="00509d">>>></font> <font color="1a936f">cd</font> overparam
      <font color="00509d">>>></font> <font color="1a936f">pip install</font> .
      </code></pre>

      Integrate to your existing PyTorch code base
      <pre><code>
      <font color="ef476f">from</font> overparam <font color="ef476f">import</font> OverparamLinear, OverparamConv2d

      # over-parameterized nn.Linear layer
      layer = <font color="118ab2">OverparamLinear</font>(<font color="f77f00">32, 32, depth=4</font>)

      # over-parameterized nn.Conv2d layer (3 layers with 3x3, 3x3, 1x1 kernels)
      layer = <font color="118ab2">OverparamConv2d</font>(<font color="f77f00">32, 64, kernel_sizes=(3, 3, 1), stride=1, padding=1</font>)
      </code></pre>

      Automatic linear over-parameterization of existing models
      <pre><code>
      <font color="ef476f">import</font> torchvision.models as models
      <font color="ef476f">from</font> overparam.utils <font color="ef476f">import</font> overparameterize

      model = models.alexnet()
      model = <font color="118ab2">overparameterize</font>(<font color="f77f00">model, depth=2</font>)
      </code></pre>

      To compute the effective rank of 2D matrix using PyTorch
      <pre><code>
      <font color="#9d4edd">def</font> <font color="118ab2">effective_rank</font>(w):
          s = w.cpu().svd(compute_uv=False)[1]
          s_hat = s / s.sum()
          <font color="#9d4edd">return</font> - (s_hat * s_hat.log()).sum()
      </code></pre>

      <br>
      <hr>
      <center> <h2> Acknowledgements </h2> </center>
      <p> We would like to thank Anurag Ajay, Lucy Chai, Tongzhou Wang, and Yen-Chen Lin for reading over the manuscript and Jeffrey Pennington and Alexei A. Efros for fruitful discussions.
          Minyoung Huh is funded by DARPA Machine Common Sense and MIT STL. Brian Cheung is funded by an MIT BCS Fellowship.
          <br><br>

          This research was also partly sponsored by the United States Air Force Research Laboratory and the United States Air Force Artificial Intelligence Accelerator and was accomplished under Cooperative Agreement Number FA8750-19-2-1000.
          The views and conclusions contained in this document are those of the authors and should not be interpreted as representing the official policies, either expressed or implied, of the United States Air Force or the U.S. Government.
          The U.S. Government is authorized to reproduce and distribute reprints for Government purposes, notwithstanding any copyright notation herein.

          <br> <br>
          <a href="https://richzhang.github.io/colorization/">Website template edited from Colorful Colorization</a>.
      </p>
      <br>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-70157890-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-70157890-3');
  </script>


</body></html>
